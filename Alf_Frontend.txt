ALF FRONT END 

15.4.2021

chrome://settings/content/sound allow URL seems to be another option instead of setting autoplay flag.


10.4 2021

Custom tabs eller Trusted Web Activity

from https://developer.chrome.com/docs/android/custom-tabs/overview/
"
When should I use Custom Tabs vs Trusted Web Activity 
Trusted Web Activities extend the Custom Tabs protocol and shares most of its benefits. But, instead of providing a customized UI, it allows developers to open a browser tab without any UI at all. It is recommended for developers who want to open their own Progressive Web App, in full screen, inside their own Android app.
"

Jag bestämde mig för att testa Trusted Web Activity
guide : https://developer.chrome.com/docs/android/trusted-web-activity/quick-start/

Vi använder bubblewrap och node.js

allt gick bra tills Initialize project.
Länken i kommandot bubblewrap init --manifest=https://my-twa.com/manifest.json är död

testar https://tomitm.github.io/appmanifest/ web app manifest generator
problem med lokala manifest filer 

hitta en fungerande "https://muteswan.app/manifest.webmanifest"

Fick inte bubblewrap att kompilera.

8.4.2021

Implementera Nugges tts API samt spela upp ljud se createSpeechFunction().

Problem med audioContexten blir suspended och måste resume eller starttas med user gesture.
Fixade detta med att starta chrome med google-chrome --autoplay-policy=no-user-gesture-required
Är detta möjligt på Android?

Implementerade och testade Speech Synthesis Markup Language (SSML) se mera på https://cloud.google.com/text-to-speech/docs/ssml

3.4.2021

Har en fungerande prototyp av webspeech apin som kan känna igen tal på svenska. 

alfApp.js är byggd runt en  Question klass som har en träd struktur, dvs. varje objekt har 2 child noder som innehåller ett till Question objekt. leaf noderna är av typen RobotFunction vilet betyder att när man når en sådan nod så tar dialogen slut och alf göra något, visar en hemsida, dansar etc. 
Trädet är uppbyggt enligt den som finns på miro. Question objektet är binärt i och med att den ändast har 2 child noder. Detta går att ändra på men man måste göra en del modifikationer i koden.

Har inte i denna version implementerat amplitud mätning utan dialogen går vidare utifrån när WebspeechAPIn har tolkat "färdigt" hela inputten. Resultatet innehåller en isFinal boolean.

man får inte aktivera speechSynthesis.speak funktionen mera i chrome utan user input https://www.chromestatus.com/feature/5687444770914304. Det här fungera dock emellanåt sporadiskt... Väldigt random. 
Det tycks fungera bättre då jag har en knapp med eventlistener fastän de inte e den som triggar speak().

Hade en del problem med SpeechRecognition objektet när man försökte start om den efter en dialog, den klagade på att den redan var startad. Försökte med att sätta till .stop() på alla möjliga platser men inget hjälpte. 
Problemet visade sig vara att .stop() utförs asynkront så koden försökte starta SpeechRecognsern före den hade hunnit stängas. Löste det med att gå vidare med nästa dialog först efter SpeechRecognition.onend har skett.

speechApi.js är en första draft som innehåller en del intressantta funktioner som inte finns i demon alfApp.js tex. mätningen av input signalens amplitud 

Ska försöka med GrammarList till näst. Detta borde gje bättre resultat tror jag.

Speech Synthersizerns som finns inbyggd i WebspeechAPIn så stöder tyvärr inte svenska. 

bra länkar:
https://developer.mozilla.org/en-US/docs/Web/API/Web_Speech_API/Using_the_Web_Speech_API


main.js innehåller ett exempel på hur man kan banda in ljud via webbrowsern samt konvertera till base64
